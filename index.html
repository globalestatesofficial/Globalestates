<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Global Estates</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body{
margin:0;
font-family:Arial;
background:#f5f7fb;
}

/* HEADER */
.header{
background:white;
padding:15px;
font-size:22px;
font-weight:bold;
box-shadow:0 2px 8px rgba(0,0,0,0.1);
display:flex;
justify-content:space-between;
align-items:center;
}

.logo{color:#2563eb}
.postBtnTop{
background:#16a34a;
color:white;
padding:8px 14px;
border-radius:8px;
font-size:14px;
border:none;
}

/* SEARCH */
.searchBox{
margin:15px;
background:white;
padding:12px;
border-radius:14px;
box-shadow:0 3px 10px rgba(0,0,0,0.08);
}
.searchBox input{
width:100%;
border:none;
font-size:16px;
outline:none;
}

/* PROPERTY CARD */
.card{
background:white;
margin:15px;
border-radius:16px;
overflow:hidden;
box-shadow:0 5px 14px rgba(0,0,0,0.1);
}
.img{
height:180px;
background:url('https://images.unsplash.com/photo-1568605114967-8130f3a36994?q=80&w=1200') center/cover;
}
.details{padding:14px}
.title{font-size:18px;font-weight:bold}
.price{color:green;font-weight:bold;margin-top:6px}
.whatsapp{
background:#25D366;
color:white;
padding:10px;
border:none;
width:100%;
border-radius:8px;
margin-top:10px;
}

/* FLOAT BUTTON */
.fab{
position:fixed;
bottom:80px;
right:20px;
background:#2563eb;
color:white;
width:60px;
height:60px;
border-radius:50%;
font-size:30px;
border:none;
box-shadow:0 5px 15px rgba(0,0,0,0.3);
}

/* BOTTOM NAV */
.nav{
position:fixed;
bottom:0;
width:100%;
background:white;
display:flex;
justify-content:space-around;
padding:10px 0;
box-shadow:0 -2px 10px rgba(0,0,0,0.15);
}
.nav div{font-size:13px;text-align:center}

/* MODAL */
.modal{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:rgba(0,0,0,0.5);
display:none;
justify-content:center;
align-items:center;
}
.modalContent{
background:white;
padding:20px;
border-radius:14px;
width:90%;
}
input{
width:100%;
padding:12px;
margin:6px 0;
border-radius:8px;
border:1px solid #ccc;
}
button{
padding:12px;
border:none;
border-radius:8px;
background:#2563eb;
color:white;
width:100%;
margin-top:8px;
}
</style>
</head>

<body>

<!-- HEADER -->
<div class="header">
<div class="logo">üè† Global Estates</div>
<button class="postBtnTop" onclick="openPost()">Post</button>
</div>

<!-- SEARCH -->
<div class="searchBox">
<input id="search" placeholder="Search city, area..." onkeyup="searchProperty()">
</div>

<!-- PROPERTY LIST -->
<div id="list"></div>

<!-- FLOAT POST -->
<button class="fab" onclick="openPost()">+</button>

<!-- BOTTOM NAV -->
<div class="nav">
<div>üè†<br>Home</div>
<div>‚ù§Ô∏è<br>Saved</div>
<div>üìû<br>Contact</div>
<div onclick="logout()">üë§<br>Logout</div>
</div>

<!-- POST MODAL -->
<div class="modal" id="postModal">
<div class="modalContent">
<h3>Post Property</h3>
<input id="title" placeholder="Property title">
<input id="price" placeholder="Price">
<input id="whatsapp" placeholder="WhatsApp number">
<button onclick="addProperty()">Submit</button>
<button onclick="closePost()">Cancel</button>
</div>
</div>

<script>
// SUPABASE
const supabase = window.supabase.createClient(
"https://okfejpqxwhykjixczwht.supabase.co",
"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9rZmVqcHF4d2h5a2ppeGN6d2h0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA3MTcxMjksImV4cCI6MjA4NjI5MzEyOX0.lz5_XWrBHnzk4VP1vtHQwYLCd5gd6oHgGxiKo0JxMps"
);

// CHECK LOGIN
checkUser();
async function checkUser(){
const {data:{user}}=await supabase.auth.getUser();
if(!user){
let email=prompt("Enter email");
let pass=prompt("Enter password");
await supabase.auth.signInWithPassword({email:email,password:pass});
}
loadProperties();
}

// LOAD
let all=[];
async function loadProperties(){
const {data}=await supabase.from("properties").select("*").order("id",{ascending:false});
all=data;
show(data);
}

// SHOW
function show(data){
const list=document.getElementById("list");
list.innerHTML="";
data.forEach(p=>{
list.innerHTML+=`
<div class="card">
<div class="img"></div>
<div class="details">
<div class="title">${p.title}</div>
<div class="price">‚Çπ ${p.price}</div>
<a href="https://wa.me/${p.whatsapp}">
<button class="whatsapp">WhatsApp Owner</button>
</a>
</div>
</div>`;
});
}

// SEARCH
function searchProperty(){
let t=document.getElementById("search").value.toLowerCase();
let f=all.filter(x=>x.title.toLowerCase().includes(t));
show(f);
}

// POST
function openPost(){postModal.style.display="flex";}
function closePost(){postModal.style.display="none";}

async function addProperty(){
const {data:{user}}=await supabase.auth.getUser();

let title=document.getElementById("title").value;
let price=document.getElementById("price").value;
let whatsapp=document.getElementById("whatsapp").value;

const {error}=await supabase.from("properties").insert([{
title,price,whatsapp,user_id:user.id
}]);

if(error){alert(error.message);return;}
alert("Posted üöÄ");
closePost();
loadProperties();
}

// LOGOUT
async function logout(){
await supabase.auth.signOut();
location.reload();
}
</script>
</body>
</html>
